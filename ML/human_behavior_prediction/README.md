# Human Behavior Prediction System

## Описание проекта

Система прогнозирования человеческого поведения на основе машинного обучения и нейронных сетей. Проект использует современные методы искусственного интеллекта для анализа поведенческих паттернов пользователей и предсказания их действий в различных сценариях.

## Функции проекта

### Основные возможности
- Прогнозирование намерений покупки пользователей
- Анализ риска оттока клиентов (churn prediction)
- Оценка уровня вовлеченности пользователей
- Классификация поведенческих паттернов
- Сегментация пользователей по поведению

### Дополнительные функции
- Генерация синтетических поведенческих данных
- Интеграция с внешними API для получения реальных данных
- Автоматическая аугментация данных
- Мониторинг дрифта данных и производительности моделей
- AI-анализ результатов и создание отчетов

## Технологический стек

### Машинное обучение
- **TensorFlow 2.13** - глубокие нейронные сети
- **PyTorch 2.0** - альтернативный фреймворк для нейронных сетей
- **XGBoost 1.7.6** - градиентный бустинг
- **LightGBM 4.0.0** - быстрый градиентный бустинг
- **CatBoost 1.2.2** - категориальный бустинг
- **Scikit-learn 1.3.0** - традиционные алгоритмы ML

### Обработка данных
- **Pandas 2.0.3** - анализ и манипуляции с данными
- **NumPy 1.24.3** - численные вычисления
- **Feature-engine 1.6.2** - инженерия признаков
- **Imbalanced-learn 0.11.0** - работа с несбалансированными данными

### Визуализация и анализ
- **Matplotlib 3.7.2** - базовые графики
- **Seaborn 0.12.2** - статистическая визуализация
- **Plotly 5.15.0** - интерактивные графики
- **SHAP 0.42.1** - интерпретация моделей
- **LIME 0.2.0.1** - локальная интерпретация

### AI интеграция
- **OpenAI API** - GPT-3.5, GPT-4 для анализа данных
- **Anthropic API** - Claude для генерации отчетов
- **Google Gemini API** - альтернативный AI сервис
- **Hugging Face** - трансформеры и модели

### Оптимизация и мониторинг
- **Optuna 3.3.0** - автоматическая оптимизация гиперпараметров
- **Yellowbrick 1.5** - визуализация производительности моделей
- **MLxtend 0.22.0** - дополнительные инструменты ML

## Архитектура проекта

```
human_behavior_prediction/
├── config.py                 # Конфигурация проекта
├── data_generator.py         # Генерация синтетических данных
├── feature_engineering.py    # Инженерия признаков
├── models.py                 # Определение моделей ML
├── evaluation.py             # Оценка производительности
├── main.py                   # Основной пайплайн
├── data_augmentation.py      # Аугментация данных
├── api_integration.py        # Интеграция с внешними API
├── monitoring.py             # Мониторинг моделей
├── requirements.txt          # Зависимости проекта
├── data/                     # Директория данных
├── models/                   # Сохраненные модели
├── results/                  # Результаты и графики
└── logs/                     # Логи системы
```

## Установка и настройка

### Системные требования
- Python 3.8 или выше
- 8+ GB RAM (рекомендуется 16+ GB)
- 4+ CPU ядер (рекомендуется 8+ ядер)
- Windows 10+, macOS 10.14+, Ubuntu 18.04+

### Установка зависимостей
```bash
# Создание виртуального окружения
python -m venv venv
source venv/bin/activate  # Linux/Mac
# или
venv\Scripts\activate  # Windows

# Установка зависимостей
pip install -r requirements.txt
```

### Настройка AI интеграции (опционально)
```bash
# Настройка API ключей
python ../setup_ai_api.py

# Тестирование подключения
python ../test_ai_integration.py
```

## Использование

### Быстрый старт
```bash
# Запуск полного пайплайна
python main.py

# Или через общий скрипт
python ../quick_train.py
```

### Программное использование

#### Создание экземпляра пайплайна
```python
from main import HumanBehaviorPredictionPipeline

pipeline = HumanBehaviorPredictionPipeline()
```

#### Генерация данных
```python
# Генерация синтетических данных
data = pipeline.generate_data(n_samples=10000)

# Загрузка существующих данных
data = pipeline.load_data('path/to/data.csv')
```

#### Подготовка признаков
```python
# Подготовка признаков для целевой переменной
X, y = pipeline.prepare_features('will_purchase')
```

#### Обучение моделей
```python
# Обучение всех моделей
X_test, y_test = pipeline.train_models(X, y)

# Оценка производительности
pipeline.evaluate_models(X_test, y_test)
```

#### AI интеграция
```python
# AI анализ данных
ai_analysis = pipeline.enhance_with_ai(X_test, y_test)

# Генерация AI инсайтов
insights = pipeline.generate_ai_insights(model_performance)

# Создание AI отчета
report = pipeline.create_ai_report(results)
```

### Параметры конфигурации

#### Основные параметры
- `n_samples` - количество образцов для генерации (по умолчанию: 10000)
- `target_column` - целевая переменная для предсказания
- `test_size` - доля тестовых данных (по умолчанию: 0.2)
- `random_state` - случайное состояние для воспроизводимости

#### Параметры моделей
- `neural_network_epochs` - количество эпох для нейронной сети
- `neural_network_batch_size` - размер батча
- `xgboost_estimators` - количество деревьев XGBoost
- `lightgbm_estimators` - количество деревьев LightGBM

## Модели машинного обучения

### Нейронные сети
- **Глубокая нейронная сеть** - многослойный перцептрон
- **Архитектура**: Входной слой → Скрытые слои → Выходной слой
- **Активация**: ReLU, Sigmoid для выходного слоя
- **Оптимизатор**: Adam
- **Функция потерь**: Binary Crossentropy

### Градиентный бустинг
- **XGBoost** - экстремальный градиентный бустинг
- **LightGBM** - быстрый градиентный бустинг
- **CatBoost** - категориальный бустинг
- **Параметры**: автоматическая оптимизация через Optuna

### Традиционные алгоритмы
- **Random Forest** - случайный лес
- **Logistic Regression** - логистическая регрессия
- **SVM** - машина опорных векторов
- **Naive Bayes** - наивный байесовский классификатор

## Оценка производительности

### Метрики классификации
- **Accuracy** - общая точность
- **Precision** - точность положительных предсказаний
- **Recall** - полнота положительных случаев
- **F1-Score** - гармоническое среднее precision и recall
- **AUC-ROC** - площадь под ROC кривой
- **AUC-PR** - площадь под Precision-Recall кривой

### Визуализация результатов
- **Confusion Matrix** - матрица ошибок
- **ROC Curve** - ROC кривая
- **Precision-Recall Curve** - PR кривая
- **Feature Importance** - важность признаков
- **Learning Curves** - кривые обучения

## Генерация данных

### Синтетические данные
Система генерирует реалистичные поведенческие данные со следующими характеристиками:
- **Демографические данные**: возраст, пол, доход, образование
- **Поведенческие данные**: длительность сессий, количество страниц
- **Психографические данные**: намерения покупки, риск оттока
- **Технические данные**: тип устройства, местоположение

### Аугментация данных
- **SMOTE** - синтетическое передискретизирование
- **ADASYN** - адаптивный синтетический отбор
- **Random Oversampling** - случайная передискретизация
- **Feature Noise** - добавление шума к признакам

## Мониторинг и обслуживание

### Отслеживание производительности
- **Drift Detection** - обнаружение дрифта данных
- **Performance Monitoring** - мониторинг метрик
- **Model Retraining** - автоматическое переобучение
- **A/B Testing** - тестирование моделей

### Логирование
- **Training Logs** - логи процесса обучения
- **Prediction Logs** - логи предсказаний
- **Error Logs** - логи ошибок
- **Performance Logs** - логи производительности

## API интеграция

### Внешние API
- **Пользовательские данные** - интеграция с CRM системами
- **Поведенческие данные** - веб-аналитика
- **Демографические данные** - внешние источники
- **AI сервисы** - OpenAI, Anthropic, Google

### Внутренний API
- **REST API** - HTTP интерфейс
- **GraphQL** - гибкий API
- **WebSocket** - реальное время
- **Batch Processing** - пакетная обработка

## Развертывание

### Локальное развертывание
```bash
# Запуск локального сервера
python api_server.py

# Тестирование API
python test_api.py
```

### Docker развертывание
```bash
# Сборка образа
docker build -t human-behavior-prediction .

# Запуск контейнера
docker run -p 8000:8000 human-behavior-prediction
```

### Kubernetes развертывание
```bash
# Применение манифестов
kubectl apply -f ../k8s/

# Проверка статуса
kubectl get pods
```

## Примеры использования

### Базовый пример
```python
from main import HumanBehaviorPredictionPipeline

# Создание пайплайна
pipeline = HumanBehaviorPredictionPipeline()

# Генерация данных
data = pipeline.generate_data(n_samples=5000)

# Подготовка признаков
X, y = pipeline.prepare_features('will_purchase')

# Обучение моделей
X_test, y_test = pipeline.train_models(X, y)

# Оценка
pipeline.evaluate_models(X_test, y_test)
```

### Продвинутый пример с AI
```python
# AI анализ данных
ai_analysis = pipeline.enhance_with_ai(X_test, y_test)

# Генерация синтетических данных через AI
synthetic_data = pipeline.ai_enhancer.generate_synthetic_training_data(
    'user_behavior', n_samples=1000
)

# Создание AI отчета
report = pipeline.create_ai_report(results)
```

## Устранение неполадок

### Частые проблемы
1. **Ошибка памяти** - уменьшите n_samples или используйте batch processing
2. **Медленное обучение** - используйте GPU или уменьшите сложность моделей
3. **Низкая точность** - проверьте качество данных и настройте гиперпараметры
4. **Ошибки API** - проверьте подключение к интернету и API ключи

### Логи и отладка
```bash
# Просмотр логов
tail -f logs/training.log

# Отладка моделей
python -c "from main import HumanBehaviorPredictionPipeline; pipeline = HumanBehaviorPredictionPipeline(); pipeline.debug_mode = True"
```

## Лицензия

Проект распространяется под лицензией MIT. См. файл LICENSE для подробностей.

## Контакты

Для вопросов и предложений обращайтесь к разработчикам проекта.

## Changelog

### Версия 1.0.0
- Первоначальный релиз
- Базовая функциональность прогнозирования
- Интеграция с AI сервисами
- Система мониторинга
- Docker и Kubernetes поддержка